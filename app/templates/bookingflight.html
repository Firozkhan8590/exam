<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Complete Your Booking - AeroTrack</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Enhanced focus styles */
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
            transition: all 0.2s ease;
        }
        /* Smooth hover transitions */
        .hover-scale {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hover-scale:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        /* Pulse animation for call-to-action */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(22, 163, 74, 0); }
            100% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0); }
        }
        .pulse-button {
            animation: pulse 2s infinite;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #bfdbfe;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #93c5fd;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header Section -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center mb-4">
                <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                </svg>
                <span class="ml-2 text-3xl font-bold text-blue-600">AeroTrack</span>
            </div>
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-4 leading-tight">Complete Your Booking</h1>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto">Review your flight details and enter passenger information</p>
            <div class="mt-6 w-20 h-1.5 bg-blue-500 rounded-full mx-auto"></div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column (Flight & Passenger Details) -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Flight Details Card -->
                <div class="bg-white p-8 rounded-2xl shadow-sm hover-scale border border-gray-100">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center">
                            <svg class="w-8 h-8 text-blue-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                            </svg>
                            Flight Details
                        </h2>
                       <span 
                        class="inline-block px-2 py-1 text-xs font-semibold rounded-full 
                        {% if status == 'confirmed' %} bg-green-100 text-green-800 
                        {% elif status == 'pending' %} bg-yellow-100 text-yellow-800 
                        {% else %} bg-red-100 text-red-800 
                        {% endif %}">
                        {{ status|title }}
                    </span>
                    </div>

                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-y-6 gap-x-8">
                        <div class="space-y-1">
                            <p class="text-sm font-medium text-gray-500">Flight Number</p>
                            <p class="text-lg font-semibold text-gray-900">{{ flights.flight_number }}</p>
                        </div>
                        <div class="space-y-1">
                            <p class="text-sm font-medium text-gray-500">Route</p>
                            <p class="text-lg font-semibold text-gray-900">{{ flights.departure_airport }} <span class="font-normal text-gray-500 mx-2">â†’</span> {{ flights.arrival_airport }}</p>
                        </div>
                        <div class="space-y-1">
                            <p class="text-sm font-medium text-gray-500">Departure Time</p>
                            <p class="text-lg font-semibold text-gray-900">{{ flights.departure_time }}</p>
                        </div>
                        <div class="space-y-1">
                            <p class="text-sm font-medium text-gray-500">Arrival Time</p>
                            <p class="text-lg font-semibold text-gray-900">{{ flights.arrival_time }}</p>
                        </div>
                        <div class=" space-y-1">
                            <p class="text-sm font-medium text-gray-500">Aircraft Type</p>
                            <p class="text-lg text-gray-800">{{ flights.aircraft_type.manufacturer }} {{ flights.aircraft_type.model }} <span class="text-gray-500">(Capacity: {{ flights.aircraft_type.seat_capacity }})</span></p>
                        </div>
                        {% if selected_seats %}
                        <div class="space-y-1">
                            <p class="text-sm font-medium text-gray-500">Selected Seats</p>
                            <p class="text-lg font-semibold text-gray-900">
                                {{ selected_seats}}
                            </p>
                        </div>
                        {% endif %}

                    </div>
                </div>

                <!-- Passenger Details Card -->
                <div class="bg-white p-8 rounded-2xl shadow-sm hover-scale border border-gray-100">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-8 flex items-center">
                        <svg class="w-8 h-8 text-blue-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-3-3H5a3 3 0 00-3 3v2h5m0 0h3v-2a3 3 0 00-3-3H5a3 3 0 00-3 3v2M7 10h.01M17 10h.01M7 14h.01M17 14h.01M12 14h.01M12 10h.01M12 6h.01M12 18h.01M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        Passenger Details
                    </h2>
                    {% if booking and booking.id  %}
                    <form method="POST" action="{% url 'review_booking' user.id flights.id booking.id %}">
                        {% csrf_token %}
                        <input type="hidden" name="searched_passengers" value="{{ searched_passengers }}">
                        {% if existing_passengers %}
    {% for passenger in existing_passengers %}
        <div class="mb-8 p-6 border border-gray-200 rounded-xl bg-gray-50">
            <div class="flex items-center justify-between mb-5">
                <h3 class="text-xl font-semibold text-gray-800">Passenger {{ forloop.counter }}</h3>
                <span class="text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full">Adult</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                    <input type="text" name="first_name_{{ forloop.counter }}" value="{{ passenger.firstname }}" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                    <input type="text" name="last_name_{{ forloop.counter }}" value="{{ passenger.lastname }}" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" name="email_{{ forloop.counter }}" value="{{ passenger.email }}" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                    <input type="tel" name="phone_{{ forloop.counter }}" value="{{ passenger.phonenumber }}" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                </div>
            </div>
        </div>
    {% endfor %}
{% else %}
    {% for i in "x"|ljust:searched_passengers %}
        <!-- Your existing empty input loop here -->
    {% endfor %}
{% endif %}


                        {% for i in "x"|ljust:searched_passengers %}
                        <div class="mb-8 p-6 border border-gray-200 rounded-xl bg-gray-50">
                            <div class="flex items-center justify-between mb-5">
                                <h3 class="text-xl font-semibold text-gray-800">Passenger {{ forloop.counter }}</h3>
                                <span class="text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full">Adult</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                <div>
                                    <label for="first_name_{{ forloop.counter }}" class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                                    <input type="text" name="first_name_{{ forloop.counter }}" id="first_name_{{ forloop.counter }}" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                                </div>
                                <div>
                                    <label for="last_name_{{ forloop.counter }}" class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                                    <input type="text" name="last_name_{{ forloop.counter }}" id="last_name_{{ forloop.counter }}" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                                </div>
                                <div>
                                    <label for="email_{{ forloop.counter }}" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                    <input type="email" name="email_{{ forloop.counter }}" id="email_{{ forloop.counter }}" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                                </div>
                                <div>
                                    <label for="phone_{{ forloop.counter }}" class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                                    <input type="tel" name="phone_{{ forloop.counter }}" id="phone_{{ forloop.counter }}" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                                </div>
                            </div>
                        </div>
                        {% endfor %}

                        <div class="p-6 border border-gray-200 rounded-xl bg-gray-50">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Contact Information</h3>
                            <p class="text-base text-gray-600 mb-6">We'll send the booking confirmation to this contact</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                <div>
                                    <label for="contact_email" class="block text-sm font-medium text-gray-700 mb-2">Contact Email</label>
                                    <input type="email" name="contact_email" id="contact_email" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                                </div>
                                <div>
                                    <label for="contact_phone" class="block text-sm font-medium text-gray-700 mb-2">Contact Phone</label>
                                    <input type="tel" name="contact_phone" id="contact_phone" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition duration-200">
                                </div>
                            </div>
                        </div>
                    
                </div>
            </div>

            <!-- Right Column (Summary & Payment) -->
            <div class="lg:col-span-1">
                <div class="sticky top-8 bg-white p-8 rounded-2xl shadow-sm hover-scale border border-gray-100">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-8 flex items-center">
                        <svg class="w-8 h-8 text-blue-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M12 7V4m0 3a3 3 0 00-3 3v2h6v-2a3 3 0 00-3-3zm-3 0V4m3 16h.01M9 16h.01M12 16h.01M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        Booking Summary
                    </h2>
{% if business_count > 0 %}
<div class="flex justify-between">
    <span>Business Class ({{ business_count }}x)</span>
    <span>â‚¹{{ business_price }}</span>
</div>
{% endif %}

{% if economy_count > 0 %}
<div class="flex justify-between">
    <span>Economy Class ({{ economy_count }}x)</span>
    <span>â‚¹{{ economy_price }}</span>
</div>
{% endif %}

<div class="flex justify-between border-t pt-2 mt-2">
    <span>Tax ({{ flights.tax }}%)</span>
    <span>â‚¹{{ tax_amount }}</span>
</div>

<div class="flex justify-between font-bold text-lg border-t pt-3 mt-3">
    <span>Total Price</span>
    <span class="text-blue-600">â‚¹{{ total_price }}</span>
</div>



                    <div class="bg-blue-50 p-5 rounded-xl text-blue-800 text-sm mb-8 border border-blue-100">
                        <div class="flex items-start">
                            <svg class="w-5 h-5 text-blue-500 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div>
                                <p class="font-bold mb-2">Travel Documents Required:</p>
                                <ul class="list-disc list-inside space-y-1.5">
                                    <li><span class="font-semibold">Domestic:</span> Government photo ID (Aadhaar, PAN, etc.)</li>
                                    <li><span class="font-semibold">International:</span> Valid passport (6+ months validity)</li>
                                    <li class="font-bold text-blue-900 mt-2">Check destination guidelines before travel</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                   <div class="text-center mt-6">
                    <button type="submit"
                        class="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-4 px-8 rounded-xl shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-200 ease-in-out text-lg pulse-button">
                        Proceed to Payment
                    </button>
                    <p class="text-xs text-gray-500 mt-3 flex items-center justify-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        Secure SSL encrypted payment
                    </p>
                
    </div>
</form>
{% else %}
<p class="text-red-500 font-semibold">Please select your seats to proceed with booking.</p>
{% endif %}
                </div>
            </div>
        </div>
    </div>
</body>
</html>